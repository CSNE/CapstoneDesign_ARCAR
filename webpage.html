<!DOCTYPE html>
<html>
<head>
	<title>ARCAR Web Renderer</title>
	<script type="module" src="./webpage.js"></script>
</head>
<body>
	<div id="buttonContainer">
	<button onclick='playbackControl("pause");'>Pause</button>
	<button onclick='playbackControl("play");'>Play</button>
	<button onclick='playbackControl("+1");'>Next</button>
	<button onclick='playbackControl("-1");'>Prev</button>
	<button onclick='playbackControl("+10");'>+10</button>
	<button onclick='playbackControl("-10");'>-10</button>
	<button onclick='playbackControl("+100");'>+100</button>
	<button onclick='playbackControl("-100");'>-100</button>
	<button onclick='playbackControl("rand");'>Random</button>
	</div>
	<div id="information"></div>
	<img id="raw" style="width:480px;height:270px;"></img>
	<img id="seg" style="width:480px;height:270px;"></img>
	<img id="str" style="width:480px;height:270px;"></img>
	<img id="com" style="width:720px;height:405px;"></img>
	<canvas id="cvs"></canvas>
	<img id="dai" style="width:480px;height:270px;"></img>
	<img id="dir" style="width:480px;height:270px;"></img>
	<img id="dcm" style="width:480px;height:270px;"></img>
	
	<script>
		// Periodically fetch data form server
		var infoDiv=document.getElementById("information");
		var rawImg=document.getElementById("raw");
		var segImg=document.getElementById("seg");
		var strImg=document.getElementById("str");
		var comImg=document.getElementById("com");
		var daiImg=document.getElementById("dai");
		var dirImg=document.getElementById("dir");
		var dcmImg=document.getElementById("dcm");
		
		function periodic(){
			var xhr=new XMLHttpRequest();
			xhr.open("GET","/information");
			xhr.addEventListener("load",function(e){
				if (xhr.status==200) infoDiv.innerHTML=xhr.responseText;
			});
			xhr.addEventListener("error",function(e){
				console.log("Request errored.");
			});
			xhr.overrideMimeType("text/plain");
			xhr.send();
			
			rawImg.src="raw.jpg?forcereload="+(new Date()).getTime();
			segImg.src="seg.jpg?forcereload="+(new Date()).getTime();
			strImg.src="str.jpg?forcereload="+(new Date()).getTime();
			comImg.src="com.jpg?forcereload="+(new Date()).getTime();
			daiImg.src="dai.jpg?forcereload="+(new Date()).getTime();
			dirImg.src="dir.jpg?forcereload="+(new Date()).getTime();
			dcmImg.src="dcm.jpg?forcereload="+(new Date()).getTime();
		}
		setInterval(periodic,200);

		function playbackControl(type){
			var xhr=new XMLHttpRequest();
			xhr.open("GET","/playbackControl?type="+encodeURIComponent(type));
			xhr.send();
		}
	</script>
	</body>
</html>
